<% content_for :title, "Truck Stops · RigRadar" %>

<div class="card card-soft mb-3">
  <div class="card-body">
    <%= form_with url: truck_stops_path, method: :get, local: true do %>
      <div class="row g-3 align-items-end">
        <div class="col-sm-4">
          <%= label_tag :q, "Search", class: "form-label" %>
          <%= text_field_tag :q, params[:q], placeholder: "Name, city, or state", class: "form-control" %>
        </div>

        <div class="col-sm-3">
          <%= label_tag :min_parking, "Min Truck Parking", class: "form-label" %>
          <%= number_field_tag :min_parking, params[:min_parking], min: 0, step: 1, placeholder: "e.g. 20", class: "form-control" %>
        </div>

        <div class="col-12">
          <label class="form-label">Providers</label>
          <div class="d-flex flex-wrap gap-3">
            <% @providers.each do |label| %>
              <div class="form-check">
                <%= check_box_tag "providers[]", label, Array(params[:providers]).include?(label),
                    id: "prov_#{label.parameterize}", class: "form-check-input" %>
                <%= label_tag "prov_#{label.parameterize}", label, class: "form-check-label" %>
              </div>
            <% end %>
          </div>
        </div>

        <div class="col-auto">
          <%= submit_tag "Filter", class: "btn btn-rr" %>
          <%= link_to "Reset", truck_stops_path, class: "btn btn-link" %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<p class="text-muted"><em>Showing <%= @truck_stops.size %> of up to 200 results.</em></p>

<div class="list-group">
  <% @truck_stops.each do |truck_stop| %>
    <div class="list-group-item">
      <div class="d-flex justify-content-between">
        <div>
          <strong><%= link_to truck_stop.name, truck_stop_path(truck_stop) %></strong>
          <% if truck_stop.provider.present? %>
            <span class="badge text-bg-primary ms-2"><%= truck_stop.provider %></span>
          <% end %>
          <div class="small text-muted">
            <%= [truck_stop.street, truck_stop.city, truck_stop.state, truck_stop.zip_code].compact.join(", ") %>
            <% if truck_stop.parking_truck.present? %> • Truck parking: <%= truck_stop.parking_truck %><% end %>
            <% if truck_stop.website.present? %> • <a href="<%= truck_stop.website %>" target="_blank" rel="noopener">Website</a><% end %>
            <% if truck_stop.direction_url.present? %> • <a href="<%= truck_stop.direction_url %>" target="_blank" rel="noopener">Directions</a><% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
